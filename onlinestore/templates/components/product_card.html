{% load static %}

<div class="product-card" style="background: white; border-radius: 16px; overflow: hidden; box-shadow: var(--shadow-sm); transition: var(--transition); position: relative;">
    <a href="{% url 'product_detail' product.slug %}" style="text-decoration: none; color: inherit;">
        {% with main_image=product.get_main_image %}
            {% if main_image %}
                <img src="{{ main_image.image.url }}" alt="{{ product.name }}" style="width: 100%; height: 300px; object-fit: cover;">
            {% else %}
                <div style="width: 100%; height: 300px; background: var(--border-color); display: flex; align-items: center; justify-content: center;">
                    <i class="bi bi-image" style="font-size: 2.5rem; color: var(--text-secondary);"></i>
                </div>
            {% endif %}
        {% endwith %}

        <div class="product-info" style="padding: 15px;">
            <h3 style="margin: 0 0 8px 0; font-size: 1rem; font-weight: 500;">{{ product.name|truncatechars:40 }}</h3>
            <p class="product-price" style="margin: 0; font-weight: 700; color: var(--accent-primary); font-size: 1.2rem;">
                {% with first_variant=product.variants.first %}
                    {% if first_variant %}
                        {{ first_variant.price }} ₽
                    {% else %}
                        {{ product.price }} ₽
                    {% endif %}
                {% endwith %}
            </p>
        </div>
    </a>

    <a href="{% url 'toggle_wishlist' product.id %}"
       class="wishlist-btn"
       style="position: absolute; top: 10px; right: 10px; background: white; border-radius: 50%; width: 35px; height: 35px; display: flex; align-items: center; justify-content: center; text-decoration: none; color: var(--text-secondary); box-shadow: var(--shadow-sm); transition: var(--transition);"
       onclick="event.preventDefault(); toggleWishlist(this, '{{ product.id }}');">
        <i class="bi bi-heart"></i>
    </a>

    <button onclick="quickAddToCart('{{ product.variants.first.id }}')"
            style="position: absolute; bottom: 10px; right: 10px; background: var(--accent-primary); color: white; border: none; border-radius: 50%; width: 35px; height: 35px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: var(--transition); box-shadow: var(--shadow-sm);"
            onmouseover="this.style.background='var(--accent-secondary)'; this.style.transform='scale(1.1)'"
            onmouseout="this.style.background='var(--accent-primary)'; this.style.transform='scale(1)'">
        <i class="bi bi-cart-plus"></i>
    </button>
</div>

